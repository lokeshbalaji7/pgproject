(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2142,1957,3219,1698],{77492:function(e,n,t){"use strict";t.d(n,{o:function(){return u}});var o=t(29901),r=t(24161),i=t(47642),a=t(47381),l=t(61250),u=o.forwardRef((function(e,n){var t=e.children,o=e.contentWrapperCssClasses,u=void 0===o?"flex-grow overflow-hidden":o,c=e.headerControl,s=e.headerWrapperCssClasses,d=void 0===s?"bg-white h-16 flex items-center px-6 border-b border-gray-100 flex-shrink-0":s,f=e.id,p=(0,r.useRecoilValue)(i.qx);return(0,l.jsxs)("div",{id:f,ref:n,"data-onboarding-watch":"create_menu_new_button",className:"absolute inset-0 flex flex-col w-full overflow-y-auto",children:[c&&(0,l.jsx)("div",{className:d,children:c}),p?(0,l.jsx)(a.a,{size:"lg"}):(0,l.jsx)("div",{className:u,children:t})]})}));u.displayName="PageScaffold"},21138:function(e,n,t){"use strict";t.d(n,{O:function(){return i}});var o=t(29901),r=t(75545),i=function(e){var n=e.scopes,t=(0,o.useCallback)((function(){return Boolean(null==n?void 0:n.includes(r.l.DOWNLOAD))}),[n]);return{hasUpdateAccess:(0,o.useCallback)((function(){return Boolean(null==n?void 0:n.includes(r.l.FULL_ACCESS))}),[n]),hasDownloadAccess:t}}},12562:function(e,n,t){"use strict";var o=t(29901);n.Z=function(e){var n=e.onPress,t=e.onRelease,r=e.dependencies,i=void 0===r?[]:r,a=e.takesPrecedence;(0,o.useEffect)((function(){var e=function(e){var t=document.activeElement;t&&t.isContentEditable||t&&"button"===t.tagName.toLowerCase()&&!a||"Shift"===e.key&&(e.preventDefault(),n())},o=function(e){var n=document.activeElement;n&&n.isContentEditable||n&&"button"===n.tagName.toLowerCase()&&!a||"Shift"===e.key&&(e.preventDefault(),t())};return window.addEventListener("keydown",e),window.addEventListener("keyup",o),function(){window.removeEventListener("keydown",e),window.removeEventListener("keydown",o)}}),i)}},1498:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return B}});var o=t(69452),r=t(89303),i=t(55312),a=t(24642),l=t.n(a),u=t(59715),c=t(26766),s=t(62295),d=t(53341),f=t(88406),p=t(26929),v=t(29901),h=t(24161),w=t(389),m=t(78010),g=t(77492),C=t(37576),E=t(99729),j=t(25044),b=t(21138),k=t(96240),x=t(12562),S=t(11957),I=t(98326),L=t(94459),y=t(89012),O=t(58773),R=t(81147),D=t(47642),_=t(48319),A=t(84258),N=t(80303),P=t(34916),F=t(30337),T=t(13485),M=t(90170),V=t(61250),W=(0,f.default)((0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.e(9019).then(t.bind(t,49019)));case 1:case"end":return e.stop()}}),e)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[49019]},modules:["project/[id].tsx -> @/components/features/download/select-zip-variation-modal-with-feature-service"]}}),Z=(0,f.default)((0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([t.e(2928),t.e(9421),t.e(3774),t.e(7773),t.e(7310)]).then(t.bind(t,10876)));case 1:case"end":return e.stop()}}),e)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[10876]},modules:["project/[id].tsx -> @/components/ui/headers/project-header"]}}),U=(0,f.default)((0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([t.e(2762),t.e(5452),t.e(5595),t.e(661)]).then(t.bind(t,52979)));case 1:case"end":return e.stop()}}),e)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[52979]},modules:["project/[id].tsx -> @/components/ui/selection-bar"]}}),G=(0,f.default)((0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.e(1811).then(t.bind(t,91811)));case 1:case"end":return e.stop()}}),e)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[91811]},modules:["project/[id].tsx -> @/components/page/project/project-file-listing"]}});function B(){var e,n,t,a,f,B,q,J,Q,Y,H,K,z,X=(0,d.useRouter)(),$=(0,E.a)().user,ee=X.query,ne=ee.from,te=ee.id,oe=ee.sort,re=ee.status,ie=ee.type,ae=(0,C.p)(),le=(0,h.useSetRecoilState)(D.qx),ue=(0,v.useState)(!1),ce=ue[0],se=ue[1],de=(0,h.useSetRecoilState)(_.QJ),fe=(0,v.useState)([]),pe=fe[0],ve=fe[1],he=(0,h.useSetRecoilState)(y.Y),we=pe.length>0,me=(0,v.useState)(!1),ge=me[0],Ce=me[1],Ee=(0,h.useRecoilValue)(A.Ol),je=(0,h.useRecoilValue)(O.cd),be=(0,u.SS)(s.AD.FILE_UPLOAD_LIMIT),ke=(0,v.useState)(null),xe=ke[0],Se=ke[1],Ie=(0,v.useState)(!1),Le=Ie[0],ye=Ie[1],Oe=(0,v.useState)(null),Re=Oe[0],De=Oe[1],_e=(0,v.useState)(null),Ae=_e[0],Ne=_e[1],Pe=(0,v.useState)(!1),Fe=Pe[0],Te=Pe[1];(0,x.Z)({onPress:function(){ye(!0)},onRelease:function(){ye(!1)}});var Me=(0,w.m8)(),Ve=(0,w.aM)({query:L.FE,variables:{id:te},pause:!te}),We=(0,r.Z)(Ve,1)[0],Ze=(0,w.aM)({query:L.f3,variables:{id:te,orderBy:oe||JSON.stringify({isFolder:"DESC",updatedAt:"DESC"}),status:re,type:ie,first:24},pause:!te}),Ue=(0,r.Z)(Ze,1)[0],Ge=(0,I.hp)(null===(e=We.data)||void 0===e||null===(n=e.project)||void 0===n?void 0:n.workspaceId),Be=(0,v.useMemo)((function(){return(0,T.fK)(Ge)}),[Ge]),qe=(0,v.useState)(null),Je=qe[0],Qe=qe[1],Ye=(0,v.useState)(!1),He=Ye[0],Ke=Ye[1],ze=be.on&&Be===N.Q.FREE,Xe=null===(t=Ue.data)||void 0===t||null===(a=t.projectFiles)||void 0===a?void 0:a.edges.map((function(e){return e.node}));(0,v.useEffect)((function(){We.fetching||(We.error?(0,F.w)(We.error):We.data&&We.data.project&&(We.data.project.isSystem||de({name:We.data.project.title,isPrivate:Boolean(We.data.project.isPrivate),projectTitle:We.data.project.title,type:"project",workspaceId:We.data.project.workspaceId,projectId:We.data.project.id}),(0,c.Z9)(new c.RG({projectId:We.data.project.id,projectName:We.data.project.title,workspaceId:We.data.project.workspaceId,url:window.location.href})),le(!1)))}),[We,X,le,de]);var $e=(null===(f=Ue.data)||void 0===f?void 0:f.projectFiles.pageInfo.endCursor)||null,en=(null===(B=Ue.data)||void 0===B?void 0:B.projectFiles.pageInfo.hasNextPage)||!1,nn=(0,v.useCallback)((function(e){De(M.RT.LOADED);var n=pe,t=n.map((function(e){return e.id})).indexOf(e);if(Xe){var r=Xe.find((function(n){return n.id===e}));if(!r)return;var i=Xe.indexOf(r);if(Le)if(null===xe)n.push(r);else{var a=(0,M.Jm)(xe,i,Xe);t>-1?(0,M.wh)(n,a):(0,M.AW)(n,a)}else t>-1?n.splice(t,1):n.push(r);Se(i)}0===n.length&&De(null),ve((0,o.Z)(n)),he(n.length)}),[pe,Xe,he,xe,Le]),tn=(0,v.useCallback)((function(){De(null),he(0),ve([]),Se(null),Te(!1)}),[he]),on=(0,v.useCallback)((function(){Ee||je?null==ae||ae.pushError(m.Vv):(Qe(null),Ce(!0))}),[Ee,je,ae]),rn=(0,v.useCallback)((function(){Ee||je?null==ae||ae.pushError(m.Vv):(Ke(!0),Ce(!0))}),[Ee,je,ae]),an=(0,v.useCallback)((function(){Ce(!1),Qe(null),Ke(!1)}),[]),ln=(0,v.useCallback)((function(e,n){Ee||je?null==ae||ae.pushError(m.Vv):(Ke(!1),Qe({id:e,name:n}),Ce(!0))}),[Ee,je,ae]),un=(0,v.useMemo)((function(){return Je?1:He||Re===M.RT.EVERYTHING?(null===(e=Ue.data)||void 0===e?void 0:e.projectFiles.totalCount)||0:pe.length;var e}),[Je,Re,pe,He,Ue]),cn=(0,k.t)(),sn=(0,v.useCallback)(function(){var e=(0,i.Z)(l().mark((function e(n){var t,o,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Je?[{id:Je.id,type:"FOLDER"}]:He||Re===M.RT.EVERYTHING?[{id:te,type:"PROJECT"}]:pe.map((function(e){return{id:e.id,type:(0,P.qR)(e)?"FOLDER":"FILE"}})),Ke(!1),Qe(null),Ce(!1),tn(),e.next=7,cn({entries:r,numberOfEntries:un,projectId:te,projectName:null===(t=We.data)||void 0===t||null===(o=t.project)||void 0===o?void 0:o.title,folderId:null==Je?void 0:Je.id,folderName:null==Je?void 0:Je.name,variant:n});case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[Je,null===(q=We.data)||void 0===q||null===(J=q.project)||void 0===J?void 0:J.title,te,pe,Re,tn,cn,un,He]),dn=(0,j._)("project-view","grid"),fn=(0,r.Z)(dn,2),pn=fn[0],vn=fn[1],hn=(0,v.useCallback)((function(){vn("grid"===pn?"list":"grid"),(0,c.Z9)(new c.rR({projectId:te,userId:null==$?void 0:$.id,view:"grid"===pn?"list":"grid"}))}),[pn,vn,te,$]),wn=(0,h.useRecoilValue)(R.h),mn=(0,v.useCallback)((function(){tn(),null==ae||ae.pushSuccess("".concat(pe.length>1?"Assets were":"Asset was"," successfully transferred to ").concat(null==wn?void 0:wn.name,"."))}),[tn,pe.length,null==wn?void 0:wn.name,ae]),gn=(0,v.useCallback)((function(e){var n,t,r=pe,i=null===(n=Ue.data)||void 0===n||null===(t=n.projectFiles)||void 0===t?void 0:t.edges.map((function(e){return e.node}));e?((0,M.AW)(r,i||[]),he(r.length),De(M.RT.LOADED),Te(!0)):((0,M.wh)(r,i||[]),he(r.length),De(null),Te(!1)),ve((0,o.Z)(r))}),[null===(Q=Ue.data)||void 0===Q||null===(Y=Q.projectFiles)||void 0===Y?void 0:Y.edges,pe,he]),Cn=(0,v.useCallback)((0,i.Z)(l().mark((function e(){var n,t,o,r,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]&&i[0],Xe&&0!==(null==Xe?void 0:Xe.length)){e.next=3;break}return e.abrupt("return");case 3:return o=t&&Ue.data?(null===(n=Ue.data)||void 0===n?void 0:n.projectFiles.totalCount)-(null==Xe?void 0:Xe.length):24,r=ze?Math.min(12,Math.abs(be.value-(null==Xe?void 0:Xe.length))):o,e.prev=5,se(!0),e.next=9,Me.query(L.f3,{id:te,status:re,type:ie,orderBy:oe||JSON.stringify({isFolder:"DESC",updatedAt:"DESC"}),after:$e,first:r}).toPromise();case 9:return e.prev=9,se(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[5,,9,12]])}))),[Xe,Ue.data,ze,be.value,Me,te,re,ie,oe,$e]),En=(0,v.useCallback)((function(){We.data&&!We.fetching&&!ce&&en&&$e&&Cn()}),[$e,Cn,We.data,We.fetching,en,ce]);(0,v.useEffect)((function(){tn()}),[X.asPath,tn]);var jn="https://creator.lottiefiles.com",bn=(0,v.useCallback)((function(e,n){var t,o,r="shared-with-me"===ne;(((0,P.QR)(e)||(0,P.xK)(e))&&(t=e.fileObject.filename.split(".").pop()),"creator"===t)?window.open("".concat(jn,"?fileId=").concat(e.id,"&utm_medium=platform&utm_source=file-card"),"_blank"):(o=(0,P.qR)(e)?"/folder/".concat(e.id):"/animation/".concat(e.id),oe&&(o+="?sort=".concat(encodeURIComponent(oe.toString()))),r&&(o+="".concat(oe?"&":"?","from=shared-with-me")),n?window.open(o,"_blank"):X.push(o))}),[ne,jn,oe,X]),kn=(null===(H=We.data)||void 0===H?void 0:H.project)||null,xn=(0,v.useCallback)((0,i.Z)(l().mark((function e(){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Xe){e.next=6;break}return e.next=3,Me.query(L.A0,{id:te}).toPromise();case 3:(n=e.sent).data&&Ne(n.data.project.stats),ve((0,o.Z)(Xe));case 6:De(M.RT.EVERYTHING);case 7:case"end":return e.stop()}}),e)}))),[Me,te,Xe]),Sn=pe.length&&(null==Xe?void 0:Xe.some((function(e){return-1===pe.findIndex((function(n){return n.id===e.id}))})))||!1,In=(0,b.O)({scopes:(null==kn?void 0:kn.projectPermissionScopes)||[]}),Ln=In.hasDownloadAccess,yn=In.hasUpdateAccess,On=(0,v.useMemo)((function(){return"folders"!==ie&&(null==kn?void 0:kn.isSystem)&&"Drafts"===(null==kn?void 0:kn.title)}),[kn,ie]),Rn=(0,v.useState)(!1),Dn=Rn[0],_n=Rn[1];return(0,v.useEffect)((function(){On&&null!=$&&$.id&&!Dn&&((0,c.Z9)(new c.di({userId:$.id})),_n(!0))}),[On,null==$?void 0:$.id,Dn]),(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(p.default,{children:(0,V.jsx)("title",{children:"LottieFiles Platform"})}),(0,V.jsxs)(S.s,{features:null==kn?void 0:kn.features,children:[(0,V.jsx)(g.o,{headerWrapperCssClasses:"flex items-center px-6 flex-shrink-0 pt-6 pb-4",contentWrapperCssClasses:"flex-grow p-6 pt-0",headerControl:(0,V.jsx)(Z,{selectedCount:pe.length,loadedCount:(null==Xe?void 0:Xe.length)||0,showFilters:0!==(null==Xe?void 0:Xe.length)||(Boolean(re)||Boolean(ie)),totalCount:(null===(K=Ue.data)||void 0===K?void 0:K.projectFiles.totalCount)||0,onSelectAll:gn,selectionIsIndeterminate:Sn,isSelectionMode:we,toggleProjectView:hn,projectView:pn,project:kn,fromSharedWithMe:"shared-with-me"===ne,selectionType:Re,onSelectEverything:xn,clearSelection:tn,showSelectionBanner:Fe,onDownloadAllClick:rn,showSelectAll:Ln()||yn()}),children:(0,V.jsx)("div",{className:"h-full space-y-3",children:kn&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(G,{files:Xe,hasNextPage:en,isCreatorDraft:On,isFetchingFiles:Ue.fetching,isFetchingMore:ce,isSelectionMode:we,onFolderDownloadAllClick:ln,onItemClick:bn,onLoadMore:En,onSelectionChange:nn,project:kn,selectedFiles:pe,status:re,type:ie,view:pn}),we?(0,V.jsx)(U,{canDelete:yn(),canDownload:Ln(),canMove:yn(),canUpdateStatus:yn(),canAddToCollection:yn(),type:"project",resourceId:kn.id,workspaceId:kn.workspace.id,selectedAnimations:pe,isPrivate:kn.isPrivate,clear:tn,onDownload:on,onTransferComplete:mn,totalCount:(null===(z=Ue.data)||void 0===z?void 0:z.projectFiles.totalCount)||0,contentStats:Ae,isEverythingSelected:Re===M.RT.EVERYTHING}):null]})})}),ge&&(0,V.jsx)(W,{show:ge,numberOfEntries:un,onClose:an,onSelect:sn,workspaceId:null==kn?void 0:kn.workspaceId})]})]})}},11957:function(e,n,t){"use strict";t.d(n,{s:function(){return l},w:function(){return u}});var o=t(62295),r=t(29901),i=t(61250),a=r.createContext({features:[]}),l=function(e){var n=e.children,t=e.features;return(0,i.jsx)(a.Provider,{value:{features:t},children:n})},u=function(){var e=r.useContext(a).features;return e?new o.UZ(e):new o.UZ([])}},89012:function(e,n,t){"use strict";t.d(n,{Y:function(){return o}});var o=(0,t(24161).atom)({key:"selectedAnimationsCount",default:0})},85446:function(e,n,t){"use strict";t.d(n,{h:function(){return r}});var o=t(24161),r=(0,o.atom)({key:"transferSelectionAtom",default:null});(0,o.atom)({key:"createNewFolder",default:!1})},81147:function(e,n,t){"use strict";t.d(n,{h:function(){return o.h}});var o=t(85446)},34916:function(e,n,t){"use strict";var o,r,i,a,l,u,c;t.d(n,{GN:function(){return o},Nn:function(){return r},hF:function(){return i},eL:function(){return a},nT:function(){return u},ws:function(){return c},QR:function(){return f},xK:function(){return p},qR:function(){return v},yx:function(){return s}}),function(e){e.DOWNLOAD="download",e.FULL_ACCESS="full_access",e.PUBLIC_DOWNLOAD="public_download",e.PUBLIC_VIEW="public_view",e.VIEW="view"}(o||(o={})),function(e){e.Loop="Loop",e.PlayOnce="PlayOnce"}(r||(r={})),function(e){e.DotLottie="lottie",e.Gif="gif",e.LottieJson="json",e.Mp4="mp4"}(i||(i={})),function(e){e.GIF="gif",e.MOV="mov",e.MP4="mp4",e.WEBM="webm"}(a||(a={})),function(e){e.DOWNLOAD="download",e.FULL_ACCESS="full_access",e.PUBLIC_DOWNLOAD="public_download",e.PUBLIC_VIEW="public_view",e.VIEW="view"}(l||(l={})),function(e){e.Approved="Approved",e.InProgress="InProgress",e.NeedsReview="NeedsReview",e.Shipped="Shipped"}(u||(u={})),function(e){e.Completed="Completed",e.Failed="Failed",e.InProgress="InProgress",e.Pending="Pending"}(c||(c={}));var s,d=function(e){return e.split(".").pop()};function f(e){if(!e.fileObject)return!1;var n=e.fileObject.filename,t=d(n);return void 0!==t&&["lottie","json"].includes(t)}function p(e){if(!e.fileObject)return!1;var n=e.fileObject.filename,t=d(n);return void 0!==t&&"creator"===t}function v(e){return e&&"Folder"===e.__typename}!function(e){e.COLOR_PALETTE="color-palette",e.DIRECT="Direct",e.PREMIUM_ANIMTIONS="premium-animations",e.URL="URL"}(s||(s={}))},75545:function(e,n,t){"use strict";var o;function r(e){return"object"==typeof e&&null!==e&&"folders"in e}t.d(n,{l:function(){return o},k:function(){return r}}),function(e){e.DOWNLOAD="download",e.FULL_ACCESS="full_access",e.VIEW="view"}(o||(o={}))},30337:function(e,n,t){"use strict";t.d(n,{w:function(){return i}});var o=t(31380),r={"Access denied!":function(e){var n,t,r,i,a,l=null!==(n=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==n?n:"",u=null!==(r=null==e||null===(i=e.extensions)||void 0===i||null===(a=i.exception)||void 0===a?void 0:a.stacktrace)&&void 0!==r?r:[];throw console.log("Error code:",l),console.log("Stacktrace:",u),new o.J},"Database query failed":function(e){var n,t,r,i,a,l=null!==(n=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==n?n:"",u=null!==(r=null==e||null===(i=e.extensions)||void 0===i||null===(a=i.exception)||void 0===a?void 0:a.stacktrace)&&void 0!==r?r:[];throw console.log("Error code:",l),console.log("Stacktrace:",u),new o.J},Forbidden:function(e){var n,t,r,i,a,l=null!==(n=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==n?n:"",u=null!==(r=null==e||null===(i=e.extensions)||void 0===i||null===(a=i.exception)||void 0===a?void 0:a.stacktrace)&&void 0!==r?r:[];throw console.log("Error code:",l),console.log("Stacktrace:",u),new o.J}};function i(e){e.networkError?console.error("Network error:",e.networkError):e.graphQLErrors&&e.graphQLErrors.length>0?e.graphQLErrors.forEach((function(e){var n,t=e.message,o=Object.keys(r).find((function(e){return t.includes(e)}));o?null===(n=r[o])||void 0===n||n.call(r,e):console.error("GraphQL error:",e)})):console.error("Unknown error:",e)}},90170:function(e,n,t){"use strict";var o;function r(e,n,t){var o=Math.min(e,n),r=Math.max(e+1,n+1);return t.splice(o,r-o)}function i(e,n){n.forEach((function(n){var t=e.findIndex((function(e){return e.id===n.id}));t>-1&&e.splice(t,1)}))}function a(e,n){n.forEach((function(n){-1===e.findIndex((function(e){return e.id===n.id}))&&e.push(n)}))}t.d(n,{RT:function(){return o},Jm:function(){return r},wh:function(){return i},AW:function(){return a}}),function(e){e.EVERYTHING="everything",e.LOADED="loaded"}(o||(o={}))},60787:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[id]",function(){return t(1498)}])}},function(e){e.O(0,[9774,2888,179],(function(){return n=60787,e(e.s=n);var n}));var n=e.O();_N_E=n}]);